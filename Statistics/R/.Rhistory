carmpgdat = read.csv("carmpgdat.csv")  # read csv file
setwd('C:/Users/ZLAI/Documents/repos/HomeworkTeX/Statistics/R')
model <- lm(MPG~VOL+HP+SP+WT, data = carmpgdat)
carmpgdat = read.csv("carmpgdat.csv")  # read csv file
model <- lm(MPG~VOL+HP+SP+WT, data = carmpgdat)
a <- coef(model)[1]
Xvol <- coef(model)[2]
Xhp <- coef(model)[3]
Xsp <- coef(model)[4]
Xwt <- coef(model)[5]
Rs <- residuals(model)
Rs
testdata1 <- as.matrix(testdata)
Y = 0
RSS = 0
n = 82
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
RSS = RSS + (Rs[i])^2
}
RSS
testdata <- carmpgdat[,c("VOL","HP","SP","WT","MPG")]
testdata1 <- as.matrix(testdata)
Y = 0
RSS = 0
n = 82
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
RSS = RSS + (Rs[i])^2
}
RSS
library(leaps)
leaps(x=testdata[,1:4], y=testdata[,5], names=names(testdata)[1:4], method="Cp")
submodel_mallow <- lm(MPG~HP+SP+WT, data = carmpgdat)
submodel_mallow
base <- lm(MPG~0, data = carmpgdat)
step(base, scope = list( upper=model, lower=~1 ), direction = "forward", trace=FALSE)
View(carmpgdat)
View(carmpgdat)
View(testdata1)
View(testdata1)
resid(model) == residuals(model)
sum(resid(model))
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
print(Rs[i])
RSS = RSS + (Rs[i])^2
}
print(RSS)
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
print(RSS)
RSS = RSS + (Rs[i])^2
}
plot(model)
plot(model)
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
RSS = RSS + (Rs[i])^2
print(RSS)
}
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
print(RSS)
RSS = RSS + (Rs[i])^2
print(RSS)
}
RSS = 0
n = 82
for (i in 1:n){
Y[i] = a + Xvol*testdata1[i,1]	+ Xhp*testdata1[i,2]	+ Xsp*testdata1[i,3] + Xwt*testdata1[i,4]
print(RSS)
RSS = RSS + (Rs[i])^2
print(RSS)
}
RSS
library(leaps)
leaps(x=testdata[,1:4], y=testdata[,5], names=names(testdata)[1:4], method="Cp")
submodel_mallow <- lm(MPG~HP+SP+WT, data = carmpgdat)
submodel_mallow
base <- lm(MPG~0, data = carmpgdat)
step(base, scope = list( upper=model, lower=~1 ), direction = "forward", trace=FALSE)
step(model, direction = "backward", trace=FALSE)
