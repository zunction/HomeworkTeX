{
    "collab_server" : "",
    "contents" : "library(leaps)\nlibrary(survey)\nlibrary(dplyr)\n\n# read csv file into dataframe car\ncar <- read.csv('carmpgdat.csv')\n\n# (a) Fitting a mulitple linear regression model\n\n# generate a linear model with normally distributed noise with the model MPG~VOL+HP+SP+WT\n# covariates <-cbind('VOL','HP','SP','WT')\nlm_car <- lm(MPG~VOL+HP+SP+WT, data = car)\n\n\n\n# estimated regression function and residual sum of squares\nprint(lm_car$coefficients)\n\n# MPG = 192.43775332 - 0.01564501 * VOL + 0.39221231 * HP - 1.29481848 * SP - 1.85980373 * WT\nRSS = sum(lm_car$residuals^2)\nprint(RSS)\n\n# (b) Mallow Cp\n\n# (i) Forward\n\n# (ii) Backward\n\n# leaps(x = car[,c('VOL','HP','SP','WT')], y = car[,'MPG'], names =c('VOL','HP','SP','WT'), method = 'Cp')\n\n\n# (c) Zheng-Loh Model Selection\n# Wald test for the covariates\n\nregTermTest(lm_car, 'VOL', null=NULL,df=Inf, method = \"Wald\")\nregTermTest(lm_car, 'HP', null=NULL,df=Inf, method = \"Wald\")\nregTermTest(lm_car, 'SP', null=NULL,df=Inf, method = \"Wald\")\nregTermTest(lm_car, 'WT', null=NULL,df=Inf, method = \"Wald\")\n\n# Wald test for VOL\n# in lm(formula = MPG ~ VOL + HP + SP + WT, data = car)\n# Chisq =  0.4698075  on  1  df: p= 0.49308 \n# \n# Wald test for HP\n# in lm(formula = MPG ~ VOL + HP + SP + WT, data = car)\n# Chisq =  23.20929  on  1  df: p= 1.4529e-06 \n# \n# Wald test for SP\n# in lm(formula = MPG ~ VOL + HP + SP + WT, data = car)\n# Chisq =  27.98266  on  1  df: p= 1.2241e-07 \n# \n# Wald test for WT\n# in lm(formula = MPG ~ VOL + HP + SP + WT, data = car)\n# Chisq =  75.97941  on  1  df: p= < 2.22e-16\n# \n# Arranging in descending order we have:\n#   WT > SP > HP > VOL\n# \n# Let lm_j be the linear model with the jth largest Wald test statistic\n\nlm_1 <- lm(MPG ~ WT, data = car)\njhat_1 = sum(lm_1$residuals^2) + 1 * RSS * log(82) \nprint (jhat_1)\n\nlm_2 <- lm(MPG ~ WT + SP, data = car)\njhat_2 = sum(lm_2$residuals^2) + 2 * RSS * log(82) \nprint (jhat_2)\n\nlm_3 <- lm(MPG ~ WT + SP + HP, data = car)\njhat_3 = sum(lm_3$residuals^2) + 3 * RSS * log(82) \nprint (jhat_3)\n\njhat_4 = RSS + 4 * RSS * log(82) \nprint (jhat_4)\n\n\nprint(RSS)\n",
    "created" : 1490713256761.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1440857373",
    "id" : "493B5DEE",
    "lastKnownWriteTime" : 1491232967,
    "last_content_update" : 1491232967975,
    "path" : "~/repos/HomeworkTeX/Statistics/R/q2.R",
    "project_path" : "q2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}