\documentclass[a4paper,10pt]{article}
\setlength{\parindent}{0cm}
\usepackage{amsmath, amssymb, amsthm, mathtools,pgfplots}
\usepackage{graphicx,caption}
\usepackage{verbatim}
\usepackage{venndiagram}
\usepackage[cm]{fullpage}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{listings}
\usepackage{color,enumerate,framed}
\usepackage{color,hyperref}
\definecolor{darkblue}{rgb}{0.0,0.0,0.5}
\hypersetup{colorlinks,breaklinks,
            linkcolor=darkblue,urlcolor=darkblue,
            anchorcolor=darkblue,citecolor=darkblue}

%\usepackage{tgadventor}
%\usepackage[nohug]{diagrams}
\usepackage[T1]{fontenc}
%\usepackage{helvet}
%\renewcommand{\familydefault}{\sfdefault}
%\usepackage{parskip}
%\usepackage{picins} %for \parpic.
%\newtheorem*{notation}{Notation}
%\newtheorem{example}{Example}[section]
%\newtheorem*{problem}{Problem}
\theoremstyle{definition}
%\newtheorem{theorem}{Theorem}
%\newtheorem*{solution}{Solution}
%\newtheorem*{definition}{Definition}
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{corollary}[theorem]{Corollary}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem*{remark}{Remark}
%\setcounter{section}{1}

\newtheorem{thm}{Theorem}[section]
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{defn}[thm]{Definition}
\newtheorem*{examp}{Example}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{rmk}[thm]{Remark}
\newtheorem*{nte}{Note}
\newtheorem*{notat}{Notation}

%\diagramstyle[labelstyle=\scriptstyle]

\lstset{frame=tb,
  language=Oz,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}


\pagestyle{fancy}




\fancyhead{}
\renewcommand{\headrulewidth}{0pt}

\lfoot{\color{black!60}{\sffamily Zhangsheng Lai}}
\cfoot{}
\cfoot{\color{black!60}{\sffamily Last modified: \today}}
\rfoot{\color{black!60}{\textsc{\thepage}}}



\begin{document}
\flushright{Zhangsheng Lai\\1002554}
\section*{Stochastic Models: Exercise 3}

\begin{enumerate}
\item
\begin{enumerate}[(i)]
\item 
The setup can be modelled by disjoint Poisson process with $s$ being the 24-hour time,
\begin{align*}
\lambda(t):=\begin{cases}
5t-35, &~8\leq t < 11\\
20, &~11\leq t < 13\\
-2t+46, &~13\leq t < 17
\end{cases}
\end{align*}
we see that the first and last are nonhomogeneous Poisson process and the middle one is a homogeneous. A Poisson process can be used to model the number of customers that arrive at different time intervals as it is a counting process.

%To justify the modelling of it to a Poisson process, we first note that for each of the 3 disjoint intervals, $N_i(0)$ for $i=1,2,3$. It also satisfy the condition of stationary and independent increments 
\item 
\begin{align*}
\mathbb{P}(N(9.5)-N(8.5)=0)&=e^{-(m(9.5)-m(8.5))}\frac{m(9.5)-m(8.5)^0}{0!}\\
&=e^{-10}
\end{align*}
\item 
\begin{align*}
\mathbb{E}(\text{number of arrivals from 8:30AM-9:30AM})&=\sum_{k=0}^{\infty}k\cdot e^{-(m(9.5)-m(8.5))}\frac{(m(9.5)-m(8.5))^k}{k!}\\
&=10\sum_{k=1}^{\infty} e^{-10}\frac{10^{k-1}}{(k-1)!}\\
&=10
\end{align*}
\end{enumerate}
\item 
\begin{align*}
\mathbb{P}(N(I_1)=k_1,\ldots,N(I_n)=k_n\mid N(U)=k)&=\frac{\mathbb{P}(N(I_1)=k_1,\ldots,N(I_n)=k_n,N(u)=k)}{\mathbb{P}(N(U)=k)}\\
&=\left(\prod_{i=1}^{n}e^{-\lambda c_i}\left.\frac{(\lambda c_i)^{k_i}}{k_i!}\right)\right/ e^{-\lambda c}\frac{(\lambda c)^k}{k!}\\
&=\frac{k!}{k_1!k_2!\ldots k_n!}\left(\frac{c_1}{c}\right)^{k_1}\left(\frac{c_2}{c}\right)^{k_2}\ldots\left(\frac{c_n}{c}\right)^{k_n}
\end{align*}

\item Let $N_i$ denote the number of families with number of member of size $i$ migrating to Batan Island over a $t$ week period and let such an event be called a type-$i$ event for $i=1,2,3,4$. Hence $N_i(t)$ is a Poisson process and $\mathbb{E}(N_i(t))=\lambda t p_i=10p_i$. Let $M(t)=\sum_{i}iN_i(t)$ denote the number of individuals migrating during a $t$-week period. 
\begin{align*}
\mathbb{E}(M(t))&=\sum_{i}i\mathbb{E}(N_i(t))\\
&=(1+4)\frac{10}{6}+(2+3)\frac{10}{3}\\
&=25
\end{align*}
To find variance, we first find $\mathbb{E}(N_i(t)^2)$
\begin{align*}
\mathbb{E}(N_i(t)^2)&=\sum_{n=0}^{\infty}n^2e^{-\lambda t p_i}\frac{(\lambda t p_i)^n}{n!}\\
&=\sum_{n=2}^{\infty}e^{-\lambda t p_i}\frac{(\lambda t p_i)^{n-2}}{(n-2)!}+\sum_{n=1}^{\infty}e^{-\lambda t p_i}\frac{(\lambda t p_i)^{n-1}}{(n-1)!}\\
&=\lambda t p_i+(\lambda t p_i)^2
\end{align*}
and so $Var(N_i(t))=\lambda t p_i$.
\begin{align*}
Var(M(t))&=\sum_{i}i^2Var(N_i(t))\\
&=(1^2+4^2)\frac{10}{6}+(2^2+3^2)\frac{10}{3}=\frac{215}{3}
\end{align*}

\item 
Suppose that the mini toys are collected at times chosen according to a homogeneous Poisson process with unit rate 1 per order of a meal. Thinning the Poisson process, for each toy $i$, we have $\{N_i(t),t \in \mathbb{Z}_{\geq0}\}$ to be a Poisson process with rate $\lambda p_i=p_i$ and independent of each other. Let $X_i$ denote the first interarrival time of the Poisson process $\{N_i(t),t\geq 0\}$ and we known that $\mathbb{P}(X_i\leq t)=e^{-tp_i}$. The number of meals to be ordered such is all the mini toys are collected is $X = \max_{1\leq i\leq m} X_i$.
\begin{align*}
\mathbb{P}(X<t) &= \prod_{i=1}^{m}\mathbb{P}(X_i\leq t)
\end{align*}
thus
\begin{align*}
\mathbb{E}(X)&=\int_{0}^{\infty}\mathbb{P}(X> t)\,dt\\
&=\int_{0}^{\infty} \prod_{i=1}^{m}\mathbb{P}(X_i> t)\,dt\\
&=\int_{0}^{\infty} \prod_{i=1}^{m}(1-e^{-tp_i})\,dt
\end{align*}

Since there is a one to one correspondence between the number of order of meals and the time, $\mathbb{E}(X)=\mathbb{E}(N)$.

\item
\begin{enumerate}[(i)]
\item
\begin{enumerate}[(a)]
\item No. This can be show as follows, where $m(t)=\int_{0}^{t}\alpha(u)\,du$
\begin{align*}
\mathbb{P}(E_1>t)&=\mathbb{P}(N(t)=0)\\
&=e^{-m(t)}\\
&=exp\left(-\int_{0}^{t}\alpha(u)\,du\right)\\
\mathbb{P}(E_2>t\mid E_1=s)&=\mathbb{P}(N(t+s)-N(s)=0\mid E_1=s)\\
&=\mathbb{P}(N(t+s)-N(s)=0),\quad \text{by independent increments}\\
&=e^{-(m(t+s)-m(s))}\\
&=exp\left(-\int_{t}^{t+s}\alpha(u)\,du\right)
\end{align*}
\item From (a), we have $\mathbb{P}(E_1\leq t)=1-exp\left(-\int_{0}^{t}\alpha(u)\,du\right)$
\end{enumerate}
\item
\begin{enumerate}[(a)]
\item For each busstop $i$, let $A_{ij}$ represent the number of passengers that board at stop $i$ and alight at stop $j$. We claim that $A_{ij}\sim Pois(\lambda_ip_{ij})$ for $j=i+1,i+2\ldots,n$. Since $D_j=\sum_{i=1}^{j-1}A_{ij}$, we have $D_j\sim Pois(\tilde{\lambda}_j)$, where $\tilde{\lambda}_j=\sum_{i=1}^{j-1}\lambda_ip_{ij}$ as the sum of finitely many Poisson random variable is Poisson. 

To show the claim, let $X\sim Pois(\lambda)$ and suppose the Poisson random variable can be classified into $n$ distinct types with type $i$ occurring with probability $p_i$, $\sum_{i=1}^np_i=1$, also let $N_i$ denote the number of occurrence of type $i$ thus $X=\sum_{i=1}^{n}N_i$. Now
\begin{align*}
\mathbb{P}(N_1=k_1, \ldots, N_n=k_n)&=\mathbb{P}(N_1=k_1, \ldots, N_n=k_n\mid X=k)\cdot \mathbb{P}(X=k)\\
&=\mathbb{P}(N_1=k_1, \ldots, N_n=k_n\mid X=k)\cdot e^{-\lambda}\frac{\lambda^k}{k!}\\
&= \binom {k} {k_1,k_2,\ldots,k_n}\cdot e^{-\lambda}\frac{\lambda^k}{k!}\\
&= \prod_{i=1}^{n} e^{-\lambda p_i}\frac{\lambda^{k_i}}{k_i!}
\end{align*}

\item It follows from (a) that $\mathbb{E}(D_j)=\sum_{i=1}^{j-1}\lambda_ip_{ij}$
\end{enumerate}

\end{enumerate}

\item
\begin{enumerate}
\item Let $N_1(t)$ and $N_2(t)$ be the type-I and type-II events where Irma Pince finds a misplaced book and fails to find a misplaced book respectively. Hence, the $N_i$s are independent Poisson process with rate $\lambda p_i$ where $i=1,2$. This the misplacements found by Irma Pince follows a homogeneous Poisson process. For $t=100$, $\mathbb{E}(N_1(100))=90 \lambda$.
\item For each shelf $i$, we can the classify the event of find a misplaced book in the shelf as a type-I event and not finding a misplaced book as a type-II event. Then the $N_1(t)$ of shelf $i$ is a Poisson process with rate $\lambda p_i$. Define $N(t)=N_1(t)+N_2(t)+N_3(t)$ and we claim that it is a Poisson process with rate of process $\lambda(p_1+p_2+p_3)$. Hence the desired probability is,
\begin{align*}
\mathbb{P}(N(3)=5)=e^{-\lambda(p_1+p_2+p_3)}\frac{(\lambda(p_1+p_2+p_3))^5}{5!}
\end{align*}
Here, we shall proof the claim that the sum of two independent Poisson process is a Poisson process. Let $\{N(t), t\geq 0\}$ and $\{M(t), t\geq 0\}$ be two independent Poisson process with rate $\lambda_1$ and $\lambda_2$ respectively. We shall show that $\{N(t)+M(t), t\geq 0\}$ is also a Poisson process by showing the four conditions.
\begin{enumerate}[(i)]
\item $N(0)+M(0)=0$
\item The independent and stationary increments are inherited from $N(t), M(t)$.
\item 
\begin{align*}
\mathbb{P}(N(h)+M(h)=1)&=\mathbb{P}(N(h)=1,M(h)=0)+\mathbb{P}(N(h)=0,M(h)=1)\\
&=(\lambda_1h+o(h))(1-\lambda_2h+o(h))+(\lambda_2h+o(h))(1-\lambda_1h+o(h)),\quad \text{since $N \perp M$}\\
&=(\lambda_1+\lambda_2)h+o(h)
\end{align*}
\item Lastly,
\begin{align*}
\mathbb{P}(N(t)+M(t)\geq 2)&= 1- (\mathbb{P}(N(t)=0,M(t)=0)+\mathbb{P}(N(t)=1,M(t)=0)+\mathbb{P}(N(t)=0,M(t)=1))\\
&= 1- (1-\lambda_1h+o(h))(1-\lambda_2h+o(h))\\
&-(\lambda_1h+o(h))(1-\lambda_2h+o(h))-(1-\lambda_1h+o(h))(\lambda_2h+o(h))\\
&=o(h)
\end{align*}
which proves our earlier claim.
\end{enumerate}


\end{enumerate}
\end{enumerate}
\end{document}