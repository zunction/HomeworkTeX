\documentclass[a4paper,10pt]{article}
\setlength{\parindent}{0cm}
\usepackage{amsmath, amssymb, amsthm, mathtools,pgfplots}
\usepackage{graphicx,caption}
\usepackage{verbatim}
\usepackage{venndiagram}
\usepackage[cm]{fullpage}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{listings}
\usepackage{color,enumerate,framed}
\usepackage{color,hyperref}
\definecolor{darkblue}{rgb}{0.0,0.0,0.5}
\hypersetup{colorlinks,breaklinks,
            linkcolor=darkblue,urlcolor=darkblue,
            anchorcolor=darkblue,citecolor=darkblue}

%\usepackage{tgadventor}
%\usepackage[nohug]{diagrams}
\usepackage[T1]{fontenc}
%\usepackage{helvet}
%\renewcommand{\familydefault}{\sfdefault}
%\usepackage{parskip}
%\usepackage{picins} %for \parpic.
%\newtheorem*{notation}{Notation}
%\newtheorem{example}{Example}[section]
%\newtheorem*{problem}{Problem}
\theoremstyle{definition}
%\newtheorem{theorem}{Theorem}
%\newtheorem*{solution}{Solution}
%\newtheorem*{definition}{Definition}
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{corollary}[theorem]{Corollary}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem*{remark}{Remark}
%\setcounter{section}{1}

\newtheorem{thm}{Theorem}[section]
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{defn}[thm]{Definition}
\newtheorem*{examp}{Example}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{rmk}[thm]{Remark}
\newtheorem*{nte}{Note}
\newtheorem*{notat}{Notation}

%\diagramstyle[labelstyle=\scriptstyle]

\lstset{frame=tb,
  language=Oz,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}


\pagestyle{fancy}




\fancyhead{}
\renewcommand{\headrulewidth}{0pt}

\lfoot{\color{black!60}{\sffamily Zhangsheng Lai}}
\cfoot{}
\cfoot{\color{black!60}{\sffamily Last modified: \today}}
\rfoot{\color{black!60}{\textsc{\thepage}}}



\begin{document}
\flushright{Zhangsheng Lai\\1002554}
\section*{Stochastic Models: Exercise 4}

\begin{enumerate}
\item 
\begin{align*}
m(t) &= \sum_{n=1}^{\infty}F_n(t),\quad \text{where $F_n(t)$ is the $n-$fold convolution.}\\
&=F(t) + \sum_{n=2}^{\infty}F_n(t) ,\quad\text{since $F(t)=F_1(t)$}\\
&=F(t)+\sum_{n=2}^{\infty} F \ast F_{n-1}(t)\\
&=F(t)+\sum_{n=2}^{\infty} \int_{0}^{t} F_{n-1}(t-x)\,dF(x)\\
&=F(t)+\int_{0}^{t} \sum_{n=1}^{\infty} F_{n}(t-x)\,dF(x)\\
&=F(t)+\int_{0}^{t} m(t-x)\,dF(x)
\end{align*}

\item Let $\{N_D(t), t \geq 0\}$ be a given delay renewal process, then
\begin{align*}
P\left[S_{N_D(t)}\leq s\right] &=\sum_{n=0}^{\infty}P\left[S_{n}\leq s, S_{n+1}>t\right]\\
&=\bar{F}(t)+\sum_{n=1}^{\infty}P\left[S_{n}\leq s, S_{n+1}>t\right]\\
&=\bar{F}(t)+\sum_{n=1}^{\infty}\int_{0}^{\infty}P\left[S_{n}\leq s, S_{n+1}>t\mid S_n=y\right]\,dF_n(y)\\
&=\bar{F}(t)+\int_{0}^{s}\bar{F}(t-y)\,d\left(\sum_{n=1}^{\infty}F_n(y)\right)\\
&=\bar{F}(t)+\int_{0}^{s}\bar{F}(t-y)\,dm_D(y),\quad \text{since $F_1(y)=G(y)$}
\end{align*}
where $m_D(y)=\sum_{n=0}^{\infty}G \ast F_{n}(y)$.
\item
\begin{align*}
P\left[X_{N(t)+1}>x\right]&=\sum_{n=0}^{\infty}P\left[X_{N(t)+1}>x\right]\\
&=\bar{F}(x)+\sum_{n=1}^{\infty}P\left[X_{N(t)+1}>x\right]\\
\end{align*}


\item
\item Given the scenario, a new cycle starts each time the policyholder payment rate reverts to $r_1$. 
\begin{enumerate}[(i)]
\item Since the claims are made with a Poisson process of rate $\lambda$, the interarrival times are exponentially distributed with parameter $\lambda$, thus it is not lattice. Hence
\begin{align*}
P_i=\frac{\mathbf{E}[\text{paying rate } r_i]}{\mathbf{E}[\text{paying rate } r_0]+\mathbf{E}[\text{paying rate } r_1]}
\end{align*}
For the given $s$ and letting $X$ denote the interarrival time, we can have either $X>s$ or $X \leq s$, which we shall use to find the expectations.
\begin{align*}
\mathbf{E}[\text{paying rate } r_0] &=\int_{s}^{\infty}(x-s)\lambda e^{-\lambda x}\,dx\\
&=\int_{s}^{\infty}x\lambda e^{-\lambda x}\,dx-\int_{s}^{\infty}s\lambda e^{-\lambda x}\,dx\\
&=\left[-\frac{x}{\lambda}e^{-\lambda x}-\frac{1}{\lambda^2}e^{-\lambda x}\right]_{s}^{\infty}+ s\left[e^{-\lambda x}\right]_{s}^{\infty}=\frac{1}{\lambda}e^{-\lambda x}\\
\mathbf{E}[\text{paying rate } r_1] &=\int_{0}^{s}x\lambda e^{-\lambda x}\,dx+\int_{s}^{\infty}s\lambda e^{-\lambda x}\,dx\\
&=\lambda\left[-\frac{x}{\lambda}e^{-\lambda x}-\frac{1}{\lambda^2}e^{-\lambda x}\right]_{0}^{s}+se^{-\lambda x}=\frac{1}{\lambda}-\frac{1}{\lambda}e^{-\lambda x}
\end{align*}
Therefore
\begin{align*}
\mathbf{E}[\text{paying at rate }r_0]&=\frac{e^{-\lambda x}/\lambda}{1/\lambda}=e^{-\lambda x} \\
\mathbf{E}[\text{paying at rate }r_1]&=\frac{1/\lambda -e^{-\lambda x}/\lambda}{1/\lambda} =1-e^{-\lambda x}
\end{align*}
\item The long-run average amount paid per unit time is 
\begin{align*}
P_0r_0+P_1r_1&=r_0e^{-\lambda x}+r_1(1-e^{-\lambda x})\\
&=r_1+(r_0-r_1)e^{-\lambda x}
\end{align*}
\end{enumerate}

\item
\begin{enumerate}[(a)]
\item To find the rate of occurrance of $d-$events, we want to find $\lim_{t\to\infty}N(t)/t$ which we know to be $1/\mu$, where $\mu$ is the expected interarrival time of a $d-$event. Since we are given that the events occur according to a Poisson process, the interarrival times, $X_i$ are exponentially distributed with parameter $\lambda$ and a $d-$event occurs when the interarrival time is less than $d$. Let a new cycle start when a $d-$event occurs, we then see that the $d-$events occur with a geometric distribution $Y$ and thus the expected number of renewals (regardless of whether it is a $d-event$ or not) to before a $d-$event occurs is $1/\mathbf{P}[X\leq d]$. The value of $mu$ is given by
\begin{align*}
\mu&=\mathbf{E}\left[\sum_{i=1}^{Y}X_i\right]=\mathbf{E}\left[Y\right]\cdot \mathbf{E}\left[X\right],\quad \text{By Wald's equation}\\
&=\frac{1}{\mathbf{P}[X\leq d]}\cdot \frac{1}{\lambda}=\frac{1}{\lambda\mathbf{P}[X\leq d]}
\end{align*}


%As the expected interarrival time is $1/\lambda$, the expected time between $d-$events is $1/\lambda \mathbf{P}[X\leq d]$ and 
thus we get that the rate is $\lambda(1- e^{-\lambda d})$.
\item Since the arrivals arrive at a rate of $\lambda$, the proportion of $d-$events is $\lambda(1-e^{-\lambda d})/\lambda=1-e^{-\lambda d}$
\end{enumerate}


\item 
\begin{enumerate}[(a)]
\item A cycle is complete when the bus arrives at SUTD and we can see it as on when it is travelling from SUTD to Simei and off when it is travelling in the other direction. Hence the proportion of the driving time spent going from SUTD to Simei is 
\begin{align*}
\frac{\mathbf{E}[\text{SUTD to Simei}]}{\mathbf{E}[\text{SUTD to Simei}]+\mathbf{E}[\text{Simei to SUTD}]}
\end{align*}
taking the distance between the two places to be $d$, the expectations are evaluated to be
\begin{align*}
\mathbf{E}[\text{SUTD to Simei}]&=\int_{40}^{50}\frac{d}{10x}\,dx=d\left[\frac{\ln x}{10}\right]_{40}^{50}=\frac{d}{10}\ln(5/4)\\
\mathbf{E}[\text{Simei to SUTD}]&= \frac{1}{2}\cdot\frac{d}{40}+\frac{1}{2}\cdot\frac{d}{50}=\frac{9d}{400}
\end{align*}
thus the proportion of time is 
\begin{align*}
\frac{d/10\ln(5/4)}{d/10\ln(5/4)+9d/400}=\frac{\ln(5/4)}{\ln(5/4)+9/40}
\end{align*}
\item The travelling speed from SUTD to Simei is uniformly distributed from 40 to 50 as such, the probability of it travelling at 40 is 0 as it is a continuous variable. Thus it suffices to consider the time at which it travels at 40 from Simei to SUTD. The proportion of time travelling at 40 from Simei to SUTD is 
\begin{align*}
\frac{d/40}{d/40+d/50}=\frac{5}{9}
\end{align*}
thus the proportion that the driving time is at a speed of 40 is 
\begin{align*}
\frac{1/8}{\ln(5/4)+9/40}
\end{align*}
\end{enumerate}

\end{enumerate}
\end{document}